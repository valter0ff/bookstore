%main.container
  = link_to :back, class: 'general-back-link' do
    %i.fa.fa-long-arrow-left.mr-15
    = t('.back_button')
  .row
    .col-sm-6
      .product-gallery
        .mb-20
          = image_tag @book.main_image, class: 'img-responsive main-image'
        .images.clearfix
          - @book.pictures.each do |picture|
            = link_to '#', class: 'img-link preview img-thumbnail' do
              = image_tag picture.image_url
          - if @book.pictures.blank?
            - Constants::Book::BOOK_IMAGES_PLACEHOLDER.each do |image_url|
              = link_to '#', class: 'img-link preview img-thumbnail' do
                = image_tag image_url
    .col-sm-6.book-info
      %h1.mt-res-0.book-title= @book.title
      %p.lead.small.book-authors
        = @book.all_authors
      .row
        .col-xs-12.col-md-4
          %p.h1.price.in-gold-500.mt-10= @book.price_with_currency
        = simple_form_for [@book, CartItem.new] do |f|
          .col-xs-5.col-md-3
            .input-group.general-position
              = link_to '#', class: 'input-link' do
                %i.fa.fa-minus.line-height-40
              = f.input_field :books_count, as: :string,
                class: 'form-control quantity-input',
                value: @cart_item.try(:books_count) || 1
              = link_to '#', class: 'input-link' do
                %i.fa.fa-plus.line-height-40
          .col-xs-7.col-md-5
            = f.button :submit, t('.add_to_cart'), class: 'btn btn-default pull-right general-position cart-btn'
        - if @cart_item.present?
          %p.text-right= t('.already_in_cart', books_count: @cart_item.books_count)
      .general-info-wrap.divider-lg
        %p= t('.descriprion')
        %p.lead.small.line-height-2.text-justify.description= @book.truncated_description
      .general-info-wrap.divider-lg
        .clearfix
          %p.pull-left= t('.year_publication')
          %p.lead.small.pull-right.year_publication= @book.year_publication
      .general-info-wrap.divider-lg
        .clearfix
          %p.pull-left= t('.dimensions_title')
          %p.lead.small.pull-right.dimensions= @book.dimensions
      .general-info-wrap.divider-lg
        .clearfix
          %p.pull-left= t('.materials')
          %p.lead.small.pull-right.materials= @book.all_materials.join(', ')
  - if user_signed_in?
    = render 'reviews/review_form', book: @book, review: @review
  = render 'reviews/reviews', reviews: @reviews
= javascript_pack_tag 'book_page/read_more'
= javascript_pack_tag 'book_page/quantity_changer'
= javascript_pack_tag 'book_page/image_replacer'
